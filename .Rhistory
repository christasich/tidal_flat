# Set working dir
setwd("C:/Projects/tidal_flat_0d")
# Read data from csv
pressure = read.csv("data/interim/sutarkhali_pressure.csv")
# Filter NaNs and normalize by mean
pressure = pressure %>%
filter(Pressure != "NaN") %>%
filter(Datetime != "NA") %>%
mutate(Pressure = Pressure - mean(Pressure)) %>%
mutate(Datetime = mdy_hms(Datetime, tz = "Asia/Dhaka")) %>%
as_tsibble(index = Datetime)
tides.sl = as.sealevel(elevation = pressure$Pressure, time = pressure$Datetime)
mod = tidem(t = tides.sl)
run_length = args[1] #years
dt = args[2]
slr = args[3]
index = seq.POSIXt(pressure$Datetime[1], pressure$Datetime[1] + years(run_length), by = dt)
end_sl = run_length * slr
sl_vec = seq(0, end_sl, length.out = length(index))
tides = tibble(Datetime = index) %>%
as_tsibble(index = Datetime) %>%
arrange(Datetime)
tides$pressure = predict(mod, newdata=index)
tides$pressure = tides$pressure + sl_vec
write_feather(tides,sprintf('./data/interim/feather/tides_%s', slr)))
library(oce)
tides.sl = as.sealevel(elevation = pressure$Pressure, time = pressure$Datetime)
mod = tidem(t = tides.sl)
setwd("C:/Projects/tidal_flat_0d")
# Read data from csv
pressure = read.csv("data/interim/sutarkhali_pressure.csv")
# Filter NaNs and normalize by mean
pressure = pressure %>%
filter(Pressure != "NaN") %>%
filter(Datetime != "NA") %>%
mutate(Pressure = Pressure - mean(Pressure)) %>%
mutate(Datetime = mdy_hms(Datetime, tz = "Asia/Dhaka")) %>%
as_tsibble(index = Datetime)
tides.sl = as.sealevel(elevation = pressure$Pressure, time = pressure$Datetime)
mod = tidem(t = tides.sl)
View(pressure)
# Read data from csv
pressure = read.csv("data/interim/sutarkhali_pressure.csv")
# Filter NaNs and normalize by mean
pressure = pressure %>%
filter(Pressure != "NaN") %>%
filter(Datetime != "NA") %>%
mutate(Pressure = Pressure - mean(Pressure)) %>%
mutate(Datetime = mdy_hms(Datetime, tz = "Asia/Dhaka")) %>%
as_tsibble(index = Datetime)
# Read data from csv
pressure = read.csv("data/interim/sutarkhali_pressure.csv")
# Filter NaNs and normalize by mean
pressure = pressure %>%
filter(Pressure != "NaN") %>%
filter(Datetime != "NA") %>%
mutate(Pressure = Pressure - mean(Pressure)) %>%
mutate(Datetime = mdy_hms(Datetime, tz = "Asia/Dhaka")) %>%
as_tsibble(index = Datetime)
View(pressure)
pressure %>%
filter(Pressure != "NaN")
library(tidyverse)
library(lubridate)
library(tsibble)
library(feather)
# Set working dir
setwd("C:/Projects/tidal_flat_0d")
# Read data from csv
pressure = read.csv("data/interim/sutarkhali_pressure.csv")
# Filter NaNs and normalize by mean
pressure = pressure %>%
filter(Pressure != "NaN") %>%
filter(Datetime != "NA") %>%
mutate(Pressure = Pressure - mean(Pressure)) %>%
mutate(Datetime = mdy_hms(Datetime, tz = "Asia/Dhaka")) %>%
as_tsibble(index = Datetime)
tides.sl = as.sealevel(elevation = pressure$Pressure, time = pressure$Datetime)
mod = tidem(t = tides.sl)
run_length = args[1] #years
dt = args[2]
slr = args[3]
index = seq.POSIXt(pressure$Datetime[1], pressure$Datetime[1] + years(run_length), by = dt)
end_sl = run_length * slr
sl_vec = seq(0, end_sl, length.out = length(index))
tides = tibble(Datetime = index) %>%
as_tsibble(index = Datetime) %>%
arrange(Datetime)
tides$pressure = predict(mod, newdata=index)
tides$pressure = tides$pressure + sl_vec
write_feather(tides,sprintf('./data/interim/feather/tides_%s', slr)))
write_feather(tides,sprintf('./data/interim/feather/tides_%s', slr))
# Set working dir
setwd("C:/Projects/tidal_flat_0d")
# Read data from csv
pressure = read.csv("data/interim/sutarkhali_pressure.csv")
# Filter NaNs and normalize by mean
pressure = pressure %>%
filter(Pressure != "NaN") %>%
filter(Datetime != "NA") %>%
mutate(Pressure = Pressure - mean(Pressure)) %>%
mutate(Datetime = mdy_hms(Datetime, tz = "Asia/Dhaka")) %>%
as_tsibble(index = Datetime)
tides.sl = as.sealevel(elevation = pressure$Pressure, time = pressure$Datetime)
mod = tidem(t = tides.sl)
run_length = args[1] #years
dt = args[2]
slr = args[3]
index = seq.POSIXt(pressure$Datetime[1], pressure$Datetime[1] + years(run_length), by = dt)
end_sl = run_length * slr
sl_vec = seq(0, end_sl, length.out = length(index))
tides = tibble(Datetime = index) %>%
as_tsibble(index = Datetime) %>%
arrange(Datetime)
tides$pressure = predict(mod, newdata=index)
tides$pressure = tides$pressure + sl_vec
write_feather(tides,sprintf('./data/interim/feather/tides_%s', slr))
library(lubridate)
library(tidyverse)
library(tsibble)
library(oce)
library(feather)
#library(gridExtra)
#library(xts)
# Set working dir
setwd("C:/Projects/tidal_flat_0d")
# Read data from csv
pressure = read.csv("data/interim/sutarkhali_pressure.csv")
# Filter NaNs and normalize by mean
pressure = pressure %>%
filter(Pressure != "NaN") %>%
filter(Datetime != "NA") %>%
mutate(Pressure = Pressure - mean(Pressure)) %>%
mutate(Datetime = mdy_hms(Datetime, tz = "Asia/Dhaka")) %>%
as_tsibble(index = Datetime)
tides.sl = as.sealevel(elevation = pressure$Pressure, time = pressure$Datetime)
mod = tidem(t = tides.sl)
run_length = 20#args[1] #years
dt = '3 Hours'#args[2]
slr = .003#args[3]
index = seq.POSIXt(pressure$Datetime[1], pressure$Datetime[1] + years(run_length), by = dt)
end_sl = run_length * slr
sl_vec = seq(0, end_sl, length.out = length(index))
tides = tibble(Datetime = index) %>%
as_tsibble(index = Datetime) %>%
arrange(Datetime)
tides$pressure = predict(mod, newdata=index)
tides$pressure = tides$pressure + sl_vec
write_feather(tides,sprintf('./data/interim/feather/tides_%s', slr))
#library(gridExtra)
library(xts)
library(lubridate)
library(tidyverse)
library(tsibble)
library(oce)
library(feather)
#library(gridExtra)
library(xts)
# Set working dir
setwd("C:/Projects/tidal_flat_0d")
# Read data from csv
pressure = read.csv("data/interim/sutarkhali_pressure.csv")
# Filter NaNs and normalize by mean
pressure = pressure %>%
filter(Pressure != "NaN") %>%
filter(Datetime != "NA") %>%
mutate(Pressure = Pressure - mean(Pressure)) %>%
mutate(Datetime = mdy_hms(Datetime, tz = "Asia/Dhaka")) %>%
as_tsibble(index = Datetime)
tides.sl = as.sealevel(elevation = pressure$Pressure, time = pressure$Datetime)
mod = tidem(t = tides.sl)
run_length = 20#args[1] #years
dt = '3 Hours'#args[2]
slr = .003#args[3]
index = seq.POSIXt(pressure$Datetime[1], pressure$Datetime[1] + years(run_length), by = dt)
end_sl = run_length * slr
sl_vec = seq(0, end_sl, length.out = length(index))
tides = tibble(Datetime = index) %>%
as_tsibble(index = Datetime) %>%
arrange(Datetime)
tides$pressure = predict(mod, newdata=index)
tides$pressure = tides$pressure + sl_vec
write_feather(tides,sprintf('./data/interim/feather/tides_%s', slr))
library(lubridate)
library(tidyverse)
library(tsibble)
library(oce)
library(feather)
library(gridExtra)
library(xts)
# Set working dir
setwd("C:/Projects/tidal_flat_0d")
# Read data from csv
pressure = read.csv("data/interim/sutarkhali_pressure.csv")
# Filter NaNs and normalize by mean
pressure = pressure %>%
filter(Pressure != "NaN") %>%
filter(Datetime != "NA") %>%
mutate(Pressure = Pressure - mean(Pressure)) %>%
mutate(Datetime = mdy_hms(Datetime, tz = "Asia/Dhaka")) %>%
as_tsibble(index = Datetime)
tides.sl = as.sealevel(elevation = pressure$Pressure, time = pressure$Datetime)
mod = tidem(t = tides.sl)
run_length = 20#args[1] #years
dt = '3 Hours'#args[2]
slr = .003#args[3]
index = seq.POSIXt(pressure$Datetime[1], pressure$Datetime[1] + years(run_length), by = dt)
end_sl = run_length * slr
sl_vec = seq(0, end_sl, length.out = length(index))
tides = tibble(Datetime = index) %>%
as_tsibble(index = Datetime) %>%
arrange(Datetime)
tides$pressure = predict(mod, newdata=index)
tides$pressure = tides$pressure + sl_vec
write_feather(tides,sprintf('./data/interim/feather/tides_%s', slr))
index = seq.POSIXt(pressure$Datetime[1], pressure$Datetime[1] + years(run_length), by = dt)
library(lubridate)
library(tidyverse)
library(tsibble)
library(oce)
library(feather)
library(gridExtra)
library(xts)
# Set working dir
setwd("C:/Projects/tidal_flat_0d")
# Read data from csv
pressure = read.csv("data/interim/sutarkhali_pressure.csv")
# Filter NaNs and normalize by mean
pressure = pressure %>%
filter(Pressure != "NaN") %>%
filter(Datetime != "NA") %>%
mutate(Pressure = Pressure - mean(Pressure)) %>%
mutate(Datetime = mdy_hms(Datetime, tz = "Asia/Dhaka")) %>%
as_tsibble(index = Datetime)
tides.sl = as.sealevel(elevation = pressure$Pressure, time = pressure$Datetime)
mod = tidem(t = tides.sl)
run_length = 20#args[1] #years
dt = '3 Hour'#args[2]
slr = .003#args[3]
index = seq.POSIXt(pressure$Datetime[1], pressure$Datetime[1] + years(run_length), by = dt)
end_sl = run_length * slr
sl_vec = seq(0, end_sl, length.out = length(index))
tides = tibble(Datetime = index) %>%
as_tsibble(index = Datetime) %>%
arrange(Datetime)
tides$pressure = predict(mod, newdata=index)
tides$pressure = tides$pressure + sl_vec
write_feather(tides,sprintf('./data/interim/feather/tides_%s', slr))
library(lubridate)
library(tidyverse)
library(tsibble)
library(oce)
library(feather)
library(gridExtra)
library(xts)
# Set working dir
setwd("C:/Projects/tidal_flat_0d")
# Read data from csv
pressure = read.csv("data/interim/sutarkhali_pressure.csv")
# Filter NaNs and normalize by mean
pressure = pressure %>%
filter(Pressure != "NaN") %>%
filter(Datetime != "NA") %>%
mutate(Pressure = Pressure - mean(Pressure)) %>%
mutate(Datetime = mdy_hms(Datetime, tz = "Asia/Dhaka")) %>%
as_tsibble(index = Datetime)
tides.sl = as.sealevel(elevation = pressure$Pressure, time = pressure$Datetime)
mod = tidem(t = tides.sl)
run_length = 20#args[1] #years
dt = '3 hour'#args[2]
slr = .003#args[3]
index = seq.POSIXt(pressure$Datetime[1], pressure$Datetime[1] + years(run_length), by = dt)
end_sl = run_length * slr
sl_vec = seq(0, end_sl, length.out = length(index))
tides = tibble(Datetime = index) %>%
as_tsibble(index = Datetime) %>%
arrange(Datetime)
tides$pressure = predict(mod, newdata=index)
tides$pressure = tides$pressure + sl_vec
write_feather(tides,sprintf('./data/interim/feather/tides_%s', slr))
library(lubridate)
library(tidyverse)
library(tsibble)
library(oce)
library(feather)
# library(gridExtra)
# library(xts)
# Set working dir
setwd("C:/Projects/tidal_flat_0d")
# Read data from csv
pressure = read.csv("data/interim/sutarkhali_pressure.csv")
# Filter NaNs and normalize by mean
pressure = pressure %>%
filter(Pressure != "NaN") %>%
filter(Datetime != "NA") %>%
mutate(Pressure = Pressure - mean(Pressure)) %>%
mutate(Datetime = mdy_hms(Datetime, tz = "Asia/Dhaka")) %>%
as_tsibble(index = Datetime)
tides.sl = as.sealevel(elevation = pressure$Pressure, time = pressure$Datetime)
mod = tidem(t = tides.sl)
run_length = 20#args[1] #years
dt = '3 hour'#args[2]
slr = .003#args[3]
index = seq.POSIXt(pressure$Datetime[1], pressure$Datetime[1] + years(run_length), by = dt)
end_sl = run_length * slr
sl_vec = seq(0, end_sl, length.out = length(index))
tides = tibble(Datetime = index) %>%
as_tsibble(index = Datetime) %>%
arrange(Datetime)
tides$pressure = predict(mod, newdata=index)
tides$pressure = tides$pressure + sl_vec
write_feather(tides,sprintf('./data/interim/feather/tides_%s', slr))
end_sl = run_length * slr
run_length * slr
